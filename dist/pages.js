(()=>{"use strict";function e(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}var t=new WeakSet,n=new WeakSet;function a(e){let t=e.substring(e.indexOf("_")+1);return t=t.replace(/_/g," "),t=t.replace(/.mp4/g,""),t}function i(e){let t=e;return t=t.replace(/.mp4/g,""),t}function l(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}var s=new WeakSet,r=new WeakSet;function o(e){let t=e.substring(e.indexOf("_")+1);return t=t.replace(/_/g," "),t=t.replace(/.jpg/g,""),t}function c(e){let t=this.element.image;return t=t.replace(/.jpg/g,""),t}const d=function(){this.createMedia=function(d){let m;switch(m="image"in d?"image":"video",m){case"image":return new class{constructor(e){r.add(this),s.add(this),this.element=e}gallery(){const e=document.createElement("div");e.classList.add("gallery__element"),e.setAttribute("data-date",this.element.date),e.setAttribute("data-likes",this.element.likes),e.setAttribute("data-id",this.element.id),e.setAttribute("data-title",l(this,s,o).call(this,this.element.image));const t=document.createElement("img");t.src=`../img/photographers/${this.element.photographerId}/${l(this,r,c).call(this,this.element.image)}.jpg`,t.alt=`${this.element.alt}, closeup view`,t.classList.add("gallery__mediaItem");const n=document.createElement("div");n.classList.add("gallery__mediaInfo");const a=document.createElement("p");a.textContent=l(this,s,o).call(this,this.element.image),a.classList.add("gallery__mediaInfo--title");const i=document.createElement("p");i.textContent=this.element.likes,i.classList.add("gallery__mediaInfo--likes");const d=document.createElement("img");d.src="../img/heart-red.svg",d.alt="likes",d.classList.add("gallery__mediaInfo--likesImg");const m=document.createElement("p");return m.textContent=`${this.element.price} $`,m.classList.add("gallery__mediaInfo--price"),n.appendChild(a),n.appendChild(m),n.appendChild(i),n.appendChild(d),e.appendChild(t),e.appendChild(n),e}lightbox(){const e=document.createElement("div");e.classList.add("carousel__item"),e.setAttribute("role","group"),e.setAttribute("aria-roledescription","slide"),e.setAttribute("data-id",this.element.id);const t=document.createElement("img");t.src=`../img/photographers/${this.element.photographerId}/${l(this,r,c).call(this,this.element.image)}.jpg`,t.alt=this.element.alt,t.classList.add("carousel__image");const n=document.createElement("p");return n.textContent=l(this,s,o).call(this,this.element.image),n.classList.add("carousel__image--title"),e.appendChild(t),e.appendChild(n),e}}(d);case"video":return new class{constructor(e){n.add(this),t.add(this),this.element=e}gallery(){const l=document.createElement("div");l.classList.add("gallery__element"),l.setAttribute("data-date",this.element.date),l.setAttribute("data-likes",this.element.likes),l.setAttribute("data-id",this.element.id),l.setAttribute("data-title",e(this,t,a).call(this,this.element.video));const s=document.createElement("video");s.classList.add("gallery__mediaItem");const r=document.createElement("source");r.src=`../img/photographers/${this.element.photographerId}/${e(this,n,i).call(this,this.element.video)}.mp4`,s.appendChild(r),s.setAttribute("aria-label",`${this.element.alt}, closeup view`);const o=document.createElement("div");o.classList.add("gallery__mediaInfo");const c=document.createElement("p");c.textContent=e(this,t,a).call(this,this.element.video),c.classList.add("gallery__mediaInfo--title");const d=document.createElement("p");d.textContent=this.element.likes,d.classList.add("gallery__mediaInfo--likes");const m=document.createElement("img");m.src="../img/heart-red.svg",m.alt="likes",m.classList.add("gallery__mediaInfo--likesImg");const u=document.createElement("p");return u.textContent=`${this.element.price} $`,u.classList.add("gallery__mediaInfo--price"),o.appendChild(c),o.appendChild(u),o.appendChild(d),o.appendChild(m),l.appendChild(s),l.appendChild(o),l}lightbox(){const l=document.createElement("div");l.classList.add("carousel__item"),l.setAttribute("role","group"),l.setAttribute("aria-roledescription","slide"),l.setAttribute("data-id",this.element.id);const s=document.createElement("video");s.classList.add("carousel__video"),s.setAttribute("controls","true"),s.setAttribute("aria-label",this.element.alt);const r=document.createElement("source");r.src=`../img/photographers/${this.element.photographerId}/${e(this,n,i).call(this,this.element.video)}.mp4`,s.appendChild(r);const o=document.createElement("p");return o.textContent=e(this,t,a).call(this,this.element.video),o.classList.add("carousel__image--title"),l.appendChild(s),l.appendChild(o),l}}(d)}}},m=window.location.pathname.split("/")[window.location.pathname.split("/").length-1],u=parseInt(m.replace(/[^0-9]/g,"")),p=document.querySelector(".main__article"),h=document.getElementById("filter-button"),g=document.getElementById("listbox"),y=document.getElementById("filter-button-arrow"),v=document.querySelector(".gallery"),E=document.querySelector(".aside"),f=document.querySelector(".modal"),_=document.querySelector(".modal__overlay"),b=document.querySelectorAll("#close, #firstname, #lastname, #email, #message, #submit"),k=b[0],L=b[b.length-1],C=document.querySelector(".modal__close"),w=document.querySelector(".form"),A=document.querySelector(".lightbox"),x=document.querySelector(".carousel"),S=document.getElementById("carousel__items"),q=document.querySelector(".carousel__controls--close"),I=document.querySelector(".carousel__controls--right"),$=document.querySelector(".carousel__controls--left"),D=[];let T=0;function P(){const e=h.innerText.toLowerCase(),t=document.querySelector(`#${e}`);t.classList.add("is-active"),y.style.WebkitTransform="rotate(180deg)",h.setAttribute("aria-expanded","true"),g.setAttribute("aria-activedescendant",t.id),g.style.display="block",g.focus()}function j(){g.style.display="none",h.setAttribute("aria-expanded","false"),g.removeAttribute("aria-activedescendant"),y.style.WebkitTransform="rotate(0deg)",h.focus()}function B(e){const t=document.querySelector(".gallery"),n=Array.from(t.children);switch(e){case"popularity":n.sort(W);break;case"date":n.sort(M);break;case"title":n.sort(N)}n.forEach((e=>{t.appendChild(e)}))}function W(e,t){const n=parseInt(e.getAttribute("data-likes"));return parseInt(t.getAttribute("data-likes"))-n}function N(e,t){const n=e.getAttribute("data-title"),a=t.getAttribute("data-title");return n<a?-1:n===a?0:1}function M(e,t){const n=new Date(e.getAttribute("data-date"));return new Date(t.getAttribute("data-date"))-n}function z(){_.style.display="none",document.querySelector(".main__article--btn").focus()}function K(e){const t=e.target.previousElementSibling,n=parseInt(t.textContent),a=document.getElementById("aside__count"),i=parseInt(a.textContent);t.textContent=n+1,a.textContent=i+1}!async function(){const e=await async function(){try{const e=await fetch("../data.json"),t=await e.json();return console.log(t),t}catch(e){console.error(e)}}();let t=e.media;const n=e.photographers;(function(e){for(let t=0;t<e.length;t++){let n=e[t];n.photographerId===u&&(D.push(n),T+=n.likes)}})(t),function(e){let t;for(let n=0;n<e.length;n++)Object.values(e[n]).some((e=>e===u))&&(t=e[n]);const n=document.createElement("div"),a=document.createElement("div");a.classList.add("main__article--wrapper");const i=document.createElement("h1");i.textContent=t.name,i.classList.add("main__article--headline");const l=document.createElement("p");l.textContent=`${t.city}, ${t.country}`,l.classList.add("main__article--location");const s=document.createElement("p");s.textContent=t.tagline,s.classList.add("main__article--tagline");const r=function(e){const t=document.createElement("div");t.className="main__article--tags";for(let n=0;n<e.length;n++){const a=document.createElement("a");a.textContent=`#${e[n]}`,a.className="main__article--tag",a.setAttribute("data-name",e[n]),a.setAttribute("aria-label",`Link to FishEye homepage showing only photographers that match the filter ${e[n]}`),a.href=`../index.html?${e[n]}`;const i=document.createElement("span");i.textContent="Tag",i.className="sr-only",a.appendChild(i),t.appendChild(a)}return t}(t.tags);n.appendChild(i),n.appendChild(l),n.appendChild(s),n.appendChild(r);const o=document.createElement("button");o.textContent="Contact me",o.classList.add("main__article--btn"),o.addEventListener("click",(e=>{e.stopPropagation(),_.style.display="flex",k.focus()})),a.appendChild(n),a.appendChild(o);const c=document.createElement("img");c.src=`../img/photographers/ID_Photos/${t.portrait}`,c.alt="",c.classList.add("main__article--img"),p.appendChild(a),p.appendChild(c);const d=document.createElement("div");d.classList.add("aside__wrapper");const m=document.createElement("span");m.id="aside__count",m.textContent=T;const h=document.createElement("img");h.src="../img/heart-black.svg",h.classList.add("aside__heart");const g=document.createElement("span");g.classList.add("aside__price"),g.textContent=`${t.price}$ / Day`,E.appendChild(d),d.appendChild(m),d.appendChild(h),d.appendChild(g)}(n),function(e){e.forEach((e=>v.appendChild(function(e){const t=(new d).createMedia(e).gallery();return t.firstElementChild.setAttribute("tabindex","0"),t.firstElementChild.addEventListener("click",(e=>{e.stopPropagation(),F(e)})),t.firstElementChild.addEventListener("keydown",(e=>{"Enter"!==e.key&&" "!==e.key||F(e)})),t}(e))));const t=document.getElementsByClassName("gallery__mediaInfo--likesImg");for(let e=0;e<t.length;e++)t[e].addEventListener("click",(e=>{e.stopPropagation(),K(e)}));if(e.length%3!=0){let e=document.createElement("div");e.classList.add("gallery__placeholder"),e.setAttribute("data-date","1900-01-01"),e.setAttribute("data-title","zzz"),e.setAttribute("data-likes","0"),v.appendChild(e)}}(D),B("popularity"),function(e){console.log(e),e.forEach((e=>{var t;S.appendChild((t=e,(new d).createMedia(t).lightbox()))}))}(D)}(),h.addEventListener("click",(e=>{e.stopPropagation(),P()})),h.addEventListener("keydown",(e=>{document.activeElement===h&&("ArrowDown"!==e.key&&"ArrowUp"!==e.key&&"Enter"!==e.key||(e.preventDefault(),P()))})),g.addEventListener("click",(e=>{e.stopPropagation();const t=document.querySelector(".is-active"),n=e.target;t.classList.remove("is-active"),n.classList.add("is-active"),g.setAttribute("aria-activedescendant",n.id);let a=document.querySelector(".is-active").innerText;h.textContent=a,j(),B(a.toLowerCase())})),g.addEventListener("keydown",(e=>{e.preventDefault();const t=document.querySelector(".is-active");let n;if(document.activeElement===g)switch(e.key){case"Home":n=g.firstElementChild;break;case"End":n=g.lastElementChild;break;case"ArrowDown":n=t.nextElementSibling,null===n&&(n=g.firstElementChild);break;case"ArrowUp":n=t.previousElementSibling,null===n&&(n=g.lastElementChild);break;case"Enter":n=document.querySelector(".is-active"),h.textContent=n.innerText,j(),B(n.innerText.toLowerCase());break;case"Escape":for(let e=0;e<document.querySelector("#listbox").children.length;e++)document.querySelector("#listbox").children[e].classList.remove("is-active");return void j()}t.classList.remove("is-active"),n.classList.add("is-active"),t.setAttribute("aria-selected","false"),n.setAttribute("aria-selected","true"),g.setAttribute("aria-activedescendant",n.id)})),document.querySelector(".main").addEventListener("click",j),f.addEventListener("keydown",(e=>{e.stopPropagation(),"Escape"===e.key&&z()})),_.addEventListener("click",(e=>{e.stopPropagation(),e.target===_&&z()})),C.addEventListener("click",(e=>{e.stopPropagation(),z()})),C.addEventListener("keydown",(e=>{e.target!==C||" "!==e.key&&"Enter"!==e.key||(e.preventDefault(),z())})),f.addEventListener("keydown",(e=>{"Tab"===e.key&&(e.shiftKey?document.activeElement===k?(e.preventDefault(),L.focus()):document.activeElement===b[1]&&(e.preventDefault(),k.focus()):document.activeElement===L&&(e.preventDefault(),k.focus()))})),w.addEventListener("submit",(e=>{e.preventDefault(),e.stopPropagation();const t=w.querySelector("#firstname"),n=w.querySelector("#lastname"),a=w.querySelector("#email"),i=w.querySelector("#message");console.log(`First name: ${t.value}, Last name: ${n.value}, Email: ${a.value}, Message: ${i.value}`),z()}));const O=Array.from(document.getElementsByClassName("carousel__controls"));function F(e){const t=document.activeElement;let n,a=document.querySelector(".gallery").firstElementChild;n=document.querySelector(".gallery").lastElementChild.classList.contains("gallery__placeholder")?document.querySelector(".gallery").lastElementChild.previousElementSibling:document.querySelector(".gallery").lastElementChild;const i=Array.from(document.querySelectorAll(".carousel__item")),l=e.target;let s=l.parentElement,r=l.parentElement.getAttribute("data-id"),o=i.find((e=>e.getAttribute("data-id")===r));function c(e){"Enter"!==e.key&&" "!==e.key||d()}function d(){o.classList.remove("active"),s=s===n?a:s.nextElementSibling,r=s.getAttribute("data-id"),o=i.find((e=>e.getAttribute("data-id")===r)),o.classList.add("active")}function m(e){"Enter"!==e.key&&" "!==e.key||u()}function u(){o.classList.remove("active"),s=s===a?n:s.previousElementSibling,r=s.getAttribute("data-id"),o=i.find((e=>e.getAttribute("data-id")===r)),o.classList.add("active")}function p(e){"Escape"===e.key?(e.preventDefault(),h()):"ArrowRight"===e.key?(e.preventDefault(),d()):"ArrowLeft"===e.key&&(e.preventDefault(),u())}function h(){A.style.display="none",i.forEach((e=>{e.classList.remove("active")})),t.focus(),x.removeEventListener("keydown",p),I.removeEventListener("click",d),I.removeEventListener("keydown",c),$.removeEventListener("click",u),$.removeEventListener("keydown",m)}A.style.display="flex",o.classList.add("active"),I.addEventListener("click",d),I.addEventListener("keydown",c),$.addEventListener("click",u),$.addEventListener("keydown",m),q.focus(),x.addEventListener("keydown",p),q.addEventListener("click",(()=>{h()})),q.addEventListener("keydown",(e=>{"Enter"!==e.key&&" "!==e.key||(e.stopPropagation(),e.preventDefault(),h())}))}x.addEventListener("keydown",(e=>{const t=O[0],n=O[O.length-1];document.activeElement===t?e.shiftKey&&"Tab"===e.key&&(e.preventDefault(),n.focus()):document.activeElement===n&&("Tab"!==e.key||e.shiftKey||(e.preventDefault(),t.focus()))}))})();